---
phase: 04-produktsystem-ueberarbeitung
plan: 04
subsystem: product-finder
tags: [product-finder, product-overview, emojis, purchase-intent]

# Dependency graph
requires:
  - phase: 04-produktsystem-ueberarbeitung
    plan: 04-01
    provides: Product overview page with personalization
provides:
  - Product finder integrated on product overview page
  - Emoji-free product finder with Lucide icons
  - Purchase intent question ("FÃ¼r sich oder andere?")
affects: [04-05-recommendations]

# Tech tracking
tech-stack:
  added: []
  patterns: [inline-product-finder, purchase-intent-flow]

key-files:
  created: []
  modified: [src/pages/produkte/index.astro, src/pages/beratung/produktfinder.astro]
---

<objective>
Integrate product finder on product overview page (/produkte), remove all emojis from product finder and replace with Lucide icons, add purchase intent question as first step.

Foundation: Existing produktfinder.astro + enhanced product overview from 04-01.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

**Product overview from 04-01:**
- Has personalized "FÃ¼r Ihre Routine" section
- Filter/sort functionality
- CTA section at bottom with product finder link

**Existing product finder:**
@src/pages/beratung/produktfinder.astro (first 80 lines show emojis: ðŸ‘¶ðŸ§’ðŸ‘¤ðŸ‘´)
- Has 4 questions with emoji options
- Separate page at /beratung/produktfinder

**Requirements from PROJECT.md:**
- Produktfinder auch auf Produkte-Seite integrieren
- Emojis entfernen (NO EMOJIS project guideline)
- 1. Frage: "Suchen Sie fÃ¼r sich oder andere?" â†’ dann Alter
</context>

<tasks>

<task type="auto">
  <name>Remove all emojis from product finder and replace with Lucide icons</name>
  <files>src/pages/beratung/produktfinder.astro</files>
  <action>
    Replace all emoji usage in product finder with Lucide icons:

    1. Question 1 age groups - replace emojis with icons:
       - ðŸ‘¶ Baby/Kleinkind â†’ &lt;Baby /&gt; icon
       - ðŸ§’ Kind â†’ &lt;User /&gt; icon with smaller size
       - ðŸ‘¤ Erwachsener â†’ &lt;User /&gt; icon
       - ðŸ‘´ Senior â†’ &lt;Users /&gt; icon or &lt;User /&gt; with badge

    2. Import needed Lucide icons at top:
       ```typescript
       import { ChevronRight, CheckCircle, Upload, Camera, ShieldCheck, Heart, Sparkles, Baby, User, Users } from '@lucide/astro';
       ```

    3. Update button structure for age groups:
       ```html
       <button class="quiz-option" data-value="baby">
         <Baby class="w-12 h-12 text-primary mb-3" />
         <span class="font-medium text-neutral-900">Baby/Kleinkind</span>
         <span class="text-sm text-neutral-600">0-6 Jahre</span>
       </button>
       ```

    4. Search entire file for any other emojis and replace with appropriate Lucide icons or text

    5. Update PROJECT.md guideline reference in file comment:
       ```html
       <!-- NO EMOJIS - Using Lucide icons per project guidelines -->
       ```

    WHY: Per PROJECT.md - "NO EMOJIS - Use Lucide icons or text descriptions instead"
  </action>
  <verify>
    1. Navigate to /beratung/produktfinder
    2. No emojis visible in any question
    3. Lucide icons display correctly for all age groups
    4. All options still functional
  </verify>
  <done>All emojis removed from product finder, replaced with Lucide icons throughout</done>
</task>

<task type="auto">
  <name>Add purchase intent question as first step</name>
  <files>src/pages/beratung/produktfinder.astro</files>
  <action>
    Add new first question about purchase intent, shift existing questions:

    1. Update progress: "Schritt X von 5" (was 4, now 5 questions)

    2. Add new Question 1 (purchase intent):
       ```html
       <!-- Question 1: Purchase Intent (NEW) -->
       <div class="quiz-step active" data-step="1">
         <h2 class="text-2xl md:text-3xl font-brand font-semibold mb-6 text-neutral-900">
           FÃ¼r wen suchen Sie?
         </h2>
         <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
           <button class="quiz-option" data-value="self">
             <User class="w-12 h-12 text-primary mb-3" />
             <span class="font-medium text-neutral-900">FÃ¼r mich selbst</span>
             <span class="text-sm text-neutral-600">PersÃ¶nliche Zahnpflege</span>
           </button>
           <button class="quiz-option" data-value="other">
             <Users class="w-12 h-12 text-primary mb-3" />
             <span class="font-medium text-neutral-900">FÃ¼r andere</span>
             <span class="text-sm text-neutral-600">Familie, Partner, Kind</span>
           </button>
         </div>
       </div>
       ```

    3. Rename old Question 1 (age) to Question 2, update data-step="2"

    4. Update all subsequent question numbers (3, 4, 5)

    5. Update JavaScript to handle new flow:
       - Store purchaseIntent answer
       - If "self" â†’ skip age question or pre-fill based on localStorage profile
       - If "other" â†’ proceed to age question normally

    6. Update recommendation logic to consider purchase intent:
       - purchaseIntent='self' + existing profile data â†’ auto-personalize
       - purchaseIntent='other' â†’ rely on age/concern selections

    WHY: Per PROJECT.md - "1. Frage: 'Suchen Sie fÃ¼r sich oder andere?' â†’ dann Alter (vereinfacht Zero-Party-Data/Profilerstellung)"
  </action>
  <verify>
    1. Navigate to /beratung/produktfinder
    2. First question asks "FÃ¼r wen suchen Sie?"
    3. Select "FÃ¼r mich selbst" â†’ continues to age or skips if profile exists
    4. Restart, select "FÃ¼r andere" â†’ shows age question
    5. Progress shows "Schritt X von 5"
  </verify>
  <done>Purchase intent question added as first step, existing questions renumbered, flow logic updated</done>
</task>

<task type="auto">
  <name>Integrate product finder on product overview page</name>
  <files>src/pages/produkte/index.astro</files>
  <action>
    Add product finder section to product overview page:

    1. Replace or enhance existing CTA section at bottom with embedded mini product finder:
       ```html
       <section class="container mx-auto px-4 mb-16">
         <div class="bg-gradient-to-br from-primary to-red-500 rounded-2xl p-8 md:p-12 text-white">
           <div class="max-w-3xl mx-auto">
             <div class="text-center mb-8">
               <h2 class="text-3xl md:text-4xl font-brand font-bold mb-4">
                 Nicht sicher, welches Produkt passt?
               </h2>
               <p class="text-lg opacity-90">
                 Unser Produktfinder hilft Ihnen in 5 Fragen zur perfekten Empfehlung
               </p>
             </div>

             <!-- Inline mini finder (Question 1 only) -->
             <div class="bg-white rounded-xl p-6 text-neutral-900">
               <h3 class="text-xl font-semibold mb-4">FÃ¼r wen suchen Sie?</h3>
               <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                 <a href="/beratung/produktfinder?intent=self" class="flex items-center gap-3 p-4 bg-neutral-50 hover:bg-neutral-100 rounded-lg transition-colors">
                   <User class="w-8 h-8 text-primary flex-shrink-0" />
                   <span class="font-medium">FÃ¼r mich selbst</span>
                 </a>
                 <a href="/beratung/produktfinder?intent=other" class="flex items-center gap-3 p-4 bg-neutral-50 hover:bg-neutral-100 rounded-lg transition-colors">
                   <Users class="w-8 h-8 text-primary flex-shrink-0" />
                   <span class="font-medium">FÃ¼r andere</span>
                 </a>
               </div>
             </div>

             <div class="text-center mt-6">
               <a href="/beratung/produktfinder" class="text-white/80 hover:text-white underline text-sm">
                 Oder starten Sie den vollstÃ¤ndigen Produktfinder â†’
               </a>
             </div>
           </div>
         </div>
       </section>
       ```

    2. Add necessary Lucide icon imports:
       ```typescript
       import { User, Users } from '@lucide/astro';
       ```

    3. Update produktfinder.astro to handle query param:
       - Read ?intent=self or ?intent=other from URL
       - Pre-select answer and advance to next question automatically
       - Smooth user experience from produkte page â†’ produktfinder

    WHY: Makes product finder more accessible, reduces friction in finding right product
  </action>
  <verify>
    1. Navigate to /produkte
    2. Scroll to bottom CTA section
    3. See inline product finder with "FÃ¼r wen suchen Sie?" question
    4. Click "FÃ¼r mich selbst" â†’ navigates to /beratung/produktfinder with intent pre-selected
    5. Return to /produkte, click "FÃ¼r andere" â†’ same flow with different intent
  </verify>
  <done>Product finder integrated on product overview page with inline first question and smooth navigation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All emojis removed from produktfinder.astro
- [ ] Lucide icons display correctly for all options
- [ ] Purchase intent question added as first step (5 questions total)
- [ ] Product finder section integrated on /produkte page
- [ ] Query param handling works (?intent=self/other)
- [ ] npm run dev starts without errors
- [ ] No console errors on /produkte or /beratung/produktfinder
</verification>

<success_criteria>
- Product finder emoji-free with Lucide icons throughout
- Purchase intent question as first step
- Product finder accessible from product overview page
- Smooth flow from /produkte to /beratung/produktfinder
- Consistent with NO EMOJIS project guideline
</success_criteria>

<output>
After completion, create `.planning/phases/04-produktsystem-ueberarbeitung/04-04-SUMMARY.md`
</output>
